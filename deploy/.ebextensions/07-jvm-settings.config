###################################################################################################
# 07-jvm-settings.config
# Otimizações da JVM para melhor performance e configuração de memória
###################################################################################################

option_settings:
  aws:elasticbeanstalk:application:environment:
    JAVA_OPTS: "-Xms1024m -Xmx2560m -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:+UseStringDeduplication -Duser.timezone=America/Sao_Paulo"
    
    # Spring Boot specific
    SERVER_PORT: 5000
    SPRING_PROFILES_ACTIVE: production
    SPRING_JPA_SHOW_SQL: false
    SPRING_JPA_PROPERTIES_HIBERNATE_GENERATE_STATISTICS: false
    
    # Tomcat optimization
    SERVER_TOMCAT_MAX_THREADS: 200
    SERVER_TOMCAT_MIN_SPARE_THREADS: 10
    SERVER_TOMCAT_ACCEPT_COUNT: 100
    SERVER_TOMCAT_MAX_CONNECTIONS: 10000
    
    # File upload
    SPRING_SERVLET_MULTIPART_MAX_FILE_SIZE: 50MB
    SPRING_SERVLET_MULTIPART_MAX_REQUEST_SIZE: 50MB

files:
  "/opt/elasticbeanstalk/tasks/bundlelogs.d/jvm.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      /var/app/current/logs/*.hprof